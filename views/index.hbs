<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <link rel="stylesheet" href="/style.css"/>
</head>
<body>
    <h1> Welcome {{user}} to the To-Do List</h1>
    <form action="/add" method="post">
        <input type="text" name="todo" placeholder="New Todo" required>
        <button type="submit"> Add Todo </button>
    </form>

    <ul>
        {{#each todos}}
        <li class="{{#if done}} done {{/if}}">
            <span class="toggle-done" data-index="{{@index}}">{{text}}</span>
            <a href="/done/{{@index}}">Mark as Done</a>
        </li>
        {{/each}}
    </ul>

    <a href="/logout">Logout</a>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const toggleDoneElements = document.querySelectorAll('.toggle-done');

            toggleDoneElements.forEach(function(element) {
                element.addEventListener("click", function() {
                    const index = this.getAttribute('data-index');
                    window.location.href = '/done' + index;
                });
            });
        });
    </script>
</body>
</html>
